/* Base styles */
:root{
  --bg: #0f1226;
  --bg-2: #171a36;
  --text: #ecf0f1;
  --muted: #a5adbb;
  --primary: #7c3aed; /* violet */
  --primary-2: #a78bfa;
  --accent: #06b6d4; /* cyan */
  --success: #22c55e;
  --danger: #ef4444;
  --card: #1c1f44;
  --shadow: rgba(0,0,0,0.35);
}
*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  color:var(--text); background:
    radial-gradient(1200px 600px at 10% -10%, rgba(124,58,237,0.25), transparent 60%),
    radial-gradient(1200px 600px at 90% 110%, rgba(6,182,212,0.2), transparent 60%),
    linear-gradient(180deg, var(--bg) 0%, var(--bg-2) 100%);
}

.app-header, .app-footer{
  display:flex; align-items:center; justify-content:space-between;
  padding:16px 24px; backdrop-filter:saturate(1.2) blur(8px);
  background:rgba(15,18,38,0.6); border-bottom:1px solid rgba(255,255,255,0.06);
}
.app-footer{ border-top:1px solid rgba(255,255,255,0.06); border-bottom:none;}
.brand{font-weight:800; letter-spacing:0.5px; color:#fff; text-decoration:none}
.nav{display:flex; gap:8px; align-items:center}
.nav-btn{display:inline-block; padding:10px 14px; border-radius:999px; background:linear-gradient(135deg, rgba(124,58,237,0.25), rgba(6,182,212,0.25)); color:#fff; text-decoration:none; border:1px solid rgba(255,255,255,0.18); transition:transform .12s, filter .2s, box-shadow .2s}
.nav-btn:hover{transform:translateY(-1px); filter:brightness(1.05)}
.nav-btn:focus-visible{outline:none; box-shadow:0 0 0 3px rgba(6,182,212,0.35)}
.nav-btn.secondary{background:transparent}
.nav-btn[aria-current="page"]{background:linear-gradient(135deg, #7c3aed, #06b6d4); border-color:transparent}

.container{max-width:980px; margin:24px auto; padding:0 16px}
.container.narrow{max-width:740px}

.controls{display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:16px}
.mode select{padding:10px 12px; border-radius:10px; background:var(--card); color:var(--text); border:1px solid rgba(255,255,255,0.08)}
.actions{display:flex; gap:8px; align-items:center}
.toggle{display:inline-flex; align-items:center; gap:6px; padding:6px 10px; border-radius:999px; background:rgba(255,255,255,0.06); border:1px solid rgba(255,255,255,0.08); font-size:14px; color:var(--text)}
.toggle input{accent-color:#7c3aed}

.btn{background:linear-gradient(135deg, rgba(124,58,237,0.9), rgba(6,182,212,0.9)); border:none; color:white; padding:10px 14px; border-radius:12px; cursor:pointer; box-shadow:0 8px 20px var(--shadow); transition:transform .12s ease, filter .2s}
.btn:hover{transform:translateY(-1px); filter:brightness(1.05)}
.btn:active{transform:translateY(1px)}
.btn.primary{background:linear-gradient(135deg, #7c3aed, #06b6d4)}
.btn.secondary{background:#2b2f5c}
.btn.outline{background:transparent; border:1px solid rgba(255,255,255,0.2)}
.btn.small{padding:8px 12px; font-size:14px}

.flashcard{position:relative}
.card{background:var(--card); border-radius:18px; padding:22px; box-shadow:0 16px 40px var(--shadow); min-height:260px}
.card-header{display:flex; justify-content:space-between; margin-bottom:12px}
.badge{font-size:12px; padding:6px 10px; border-radius:999px; background:rgba(124,58,237,0.25); color:#e9d5ff; border:1px solid rgba(124,58,237,0.45)}
.q-index{color:var(--muted)}
.question-text{font-size:22px; line-height:1.5; margin:12px 0 16px}
.question-pos{font-size:13px; color:var(--muted); margin-bottom:8px}
.answer-area{display:grid; gap:10px}
.answer-input{width:100%; padding:12px 14px; border-radius:14px; border:1px solid rgba(255,255,255,0.12); background:#101431; color:var(--text); box-shadow:inset 0 0 0 1px rgba(255,255,255,0.04)}
.answer-input::placeholder{color:#8a93a5}
.answer-input:focus{outline:none; border-color:rgba(124,58,237,0.6); box-shadow:0 0 0 3px rgba(124,58,237,0.25)}
textarea.answer-input{min-height:96px; resize:vertical; line-height:1.4}
.word-input{padding-left:44px; position:relative; background:
  linear-gradient(90deg, rgba(124,58,237,0.35) 0 6px, transparent 6px) no-repeat,
  #101431; border-radius:14px}
.def-item .btn.secondary{min-width:42px}
.choice{display:block; width:100%; text-align:left; padding:12px 14px; border-radius:12px; background:#141738; border:1px solid rgba(255,255,255,0.08); cursor:pointer; color:var(--text); transition:background .15s}
.choice:hover{background:#1a1e45}
.choice.correct{border-color:rgba(34,197,94,0.8); box-shadow:0 0 0 2px rgba(34,197,94,0.25) inset}
.choice.wrong{border-color:rgba(239,68,68,0.8); box-shadow:0 0 0 2px rgba(239,68,68,0.25) inset}
.feedback{min-height:22px; margin:6px 2px; color:var(--muted)}
.card-footer{display:flex; justify-content:flex-end; margin-top:8px}

/* Post-answer extras */
.post-answer{margin-top:8px; display:grid; gap:8px}
.post-row{display:flex; gap:8px; align-items:center}
.translation{background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); padding:10px 12px; border-radius:12px}
.translation-row{margin:4px 0}
.translation .muted{color:var(--muted)}
.translation-links{display:flex; gap:8px; flex-wrap:wrap; margin-top:6px}

/* Animations */
@keyframes correctGlow{0%{box-shadow:0 0 0 0 rgba(34,197,94,0.4)} 100%{box-shadow:0 0 0 14px rgba(34,197,94,0)}}
@keyframes shake{10%, 90%{transform:translateX(-1px)} 20%, 80%{transform:translateX(2px)} 30%, 50%, 70%{transform:translateX(-4px)} 40%, 60%{transform:translateX(4px)}}
.card.correct{animation:correctGlow .8s ease-out}
.card.wrong{animation:shake .4s ease}

.stats{display:flex; gap:18px; margin:16px 0}
.stat{background:rgba(255,255,255,0.04); padding:12px 16px; border-radius:12px}
.stat .label{font-size:12px; color:var(--muted)}
.stat .value{font-size:20px; font-weight:800}

/* Admin */
.page-title{margin-top:8px}
.data-form{background:var(--card); padding:18px; border-radius:16px; box-shadow:0 16px 40px var(--shadow)}
.form-row{display:flex; flex-direction:column; gap:8px; margin-bottom:14px}
.defs-container{display:grid; gap:8px}
.def-item{display:flex; gap:8px}
.def-item input{flex:1}
.io-panel{margin-top:18px; background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); padding:12px; border-radius:12px}
.io-actions{display:flex; gap:8px; flex-wrap:wrap}
.hint{color:var(--muted)}
/* Notice styles */
.io-panel.notice{border-color:rgba(6,182,212,0.35); background:rgba(6,182,212,0.08)}
.io-panel.notice.warn{border-color:rgba(234,179,8,0.45); background:rgba(234,179,8,0.08)}
.list{list-style:none; padding-left:0}
.list li{padding:8px 0; border-bottom:1px dashed rgba(255,255,255,0.08)}

/* Dataset box: scrollable to avoid overflow */
.dataset-list{margin-top:18px}
.dataset-list .list{
  max-height: 40vh;
  overflow-y: auto;
  padding-right: 8px;
}
/* Optional nicer scrollbar on WebKit */
.dataset-list .list::-webkit-scrollbar{width:8px}
.dataset-list .list::-webkit-scrollbar-thumb{background:rgba(255,255,255,0.15); border-radius:8px}
.dataset-list .list::-webkit-scrollbar-track{background:transparent}

/* Collapsible summary */
.dataset-list details{background:rgba(255,255,255,0.04); border:1px solid rgba(255,255,255,0.06); border-radius:12px}
.dataset-list summary{list-style:none; cursor:pointer; padding:12px 14px; display:flex; align-items:center; gap:10px}
.dataset-list summary::-webkit-details-marker{display:none}
.dataset-list .collapsible-header{justify-content:space-between}
.dataset-list .muted-count{color:var(--muted); font-size:14px}
.dataset-list .chev{transition:transform .15s ease}
.dataset-list details[open] .chev{transform:rotate(180deg)}
.dataset-list #datasetInfo{padding:10px 14px; color:var(--muted)}
.dataset-list .list{margin:0 0 8px}

/* Confetti canvas */
.confetti-canvas{position:absolute; inset:0; pointer-events:none}

/* Flip-card (Study) */
.flip-wrap{perspective:1200px; max-width:840px; margin:0 auto; display:grid; place-items:center}
.flip-card{
  position:relative; width:100%; min-height:360px; max-width:760px;
  border-radius:18px; box-shadow:0 16px 40px var(--shadow);
  transform-style:preserve-3d; transition:transform .55s ease, box-shadow .2s;
  cursor:pointer; outline:none; border:1px solid rgba(255,255,255,0.06);
}
.flip-card:focus-visible{box-shadow:0 0 0 3px rgba(6,182,212,0.35), 0 16px 40px var(--shadow)}
.flip-card.is-flipped{transform:rotateY(180deg)}
.flip-face{
  position:absolute; inset:0; border-radius:18px;
  background:
    linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0) 20%),
    var(--card);
  padding:22px; backface-visibility:hidden; display:flex; flex-direction:column;
}
.flip-face::after{
  content:""; position:absolute; inset:0; pointer-events:none; border-radius:18px;
  border:1px solid rgba(255,255,255,0.06);
}
.flip-back{transform:rotateY(180deg)}
.fc-header{display:flex; justify-content:space-between; align-items:center}
.fc-word{font-size:32px; font-weight:800; margin:10px 0 8px; letter-spacing:.2px}
/* Part-of-speech badge on flashcards */
.fc-pos{font-size:13px; display:inline-block; margin-bottom:8px; color:var(--muted); background:rgba(255,255,255,0.02); padding:6px 8px; border-radius:10px}
.fc-image{margin:6px 0 8px}
.fc-image img{max-width:100%; border-radius:12px; display:block}
.fc-defs{margin:8px 0 0; padding-left:18px}
.fc-defs li{margin:6px 0}
.fc-meaning{font-size:18px; margin:8px 0}
.fc-explain{margin-top:8px}
.fc-ex-list{margin:8px 0 0; padding-left:18px}
.fc-hint{margin-top:auto; font-size:12px; color:var(--muted)}
.fc-actions{display:flex; gap:8px; align-items:center; margin:6px 0 2px}

/* Contrast theme for card to stand out */
.flip-card.theme-contrast{ border-color: rgba(255,255,255,0.0); }
.flip-card.theme-contrast .flip-face{
  background:
    linear-gradient(180deg, rgba(255,255,255,0.9), rgba(255,255,255,0.88));
  color:#0f172a;
}
.flip-card.theme-contrast .flip-face::after{ border-color: rgba(0,0,0,0.06); }
.flip-card.theme-contrast .badge{ background:rgba(6,182,212,0.16); color:#0f172a; border-color:rgba(6,182,212,0.35) }
.flip-card.theme-contrast .q-index{ color:#475569 }
.flip-card.theme-contrast .muted{ color:#64748b }
.flip-card.theme-contrast .fc-image img{ box-shadow: 0 8px 24px rgba(0,0,0,0.12) }

/* Fullscreen mode (modal-like) */
.flip-card.fullscreen{
  position:fixed; left:50%; top:50%; transform:translate(-50%, -50%) rotateY(0deg);
  width:min(920px, 92vw); min-height:420px; max-height: 86vh; z-index:1100;
}
.flip-card.fullscreen.is-flipped{ transform:translate(-50%, -50%) rotateY(180deg) }
.modal-backdrop.fs-backdrop{ position:fixed; inset:0; background:rgba(0,0,0,0.5); backdrop-filter:blur(2px); z-index:1099 }

/* Slider overlay buttons */
.slide-btn{
  position:absolute; top:50%; transform:translateY(-50%);
  width:42px; height:42px; border-radius:999px; border:1px solid rgba(0,0,0,0.12);
  background:rgba(255,255,255,0.85); color:#0f172a; cursor:pointer;
  box-shadow:0 6px 20px rgba(0,0,0,0.2); display:grid; place-items:center;
}
.slide-btn:hover{ filter:brightness(1.05) }
.slide-prev{ left: -18px }
.slide-next{ right: -18px }
@media (max-width: 640px){
  .slide-prev{ left: -6px } .slide-next{ right: -6px }
}

/* Simple fade when changing card */
.flip-card.fading .flip-face{ animation: fadeInQuick .18s ease both }
@keyframes fadeInQuick{ from{ opacity:0 } to{ opacity:1 } }

/* Responsive */
@media (max-width: 640px){
  .app-header, .app-footer{padding:12px 14px}
  .nav{flex-wrap:wrap; gap:6px}
  .nav-btn{padding:8px 12px; font-size:14px}
  .container{margin:16px auto}
  .controls{flex-direction:column; align-items:stretch; gap:10px}
  .actions{flex-wrap:wrap}
  .card{padding:16px; min-height:220px}
  .question-text{font-size:18px}
  .choice{padding:14px; font-size:16px}
  .stats{flex-wrap:wrap; gap:10px}
  .dataset-list .list{max-height:50vh}
}

@media (max-width: 420px){
  .brand{font-size:18px}
  .nav-btn{font-size:13px}
  .mode select{width:100%}
  .btn{padding:10px 12px}
  .btn.small{padding:8px 10px}
  .answer-input{padding:12px}
  .question-text{font-size:16px}
}

/* Toast */
.toast{position:fixed; left:50%; bottom:24px; transform:translateX(-50%);
  background:rgba(28,31,68,0.95); color:#e5e7eb; padding:10px 14px; border-radius:12px;
  border:1px solid rgba(255,255,255,0.1); box-shadow:0 10px 30px var(--shadow);
  opacity:0; pointer-events:none; transition:opacity .2s, transform .2s;
}
.toast.show{opacity:1; transform:translateX(-50%) translateY(-4px)}
.toast.success{border-color:rgba(34,197,94,0.6)}
.toast.error{border-color:rgba(239,68,68,0.6)}

/* Modal */
.modal{position:fixed; inset:0; z-index:1000}
.modal[aria-hidden="true"]{display:none}
.modal-backdrop{position:absolute; inset:0; background:rgba(0,0,0,0.5); backdrop-filter:blur(2px)}
.modal-dialog{position:relative; z-index:1; max-width:560px; margin:10vh auto; background:var(--card); border-radius:16px; padding:18px; border:1px solid rgba(255,255,255,0.08); box-shadow:0 30px 80px rgba(0,0,0,0.45)}
.modal-dialog h2{margin-top:0}

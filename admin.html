<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>FlashSheet — Nhập dữ liệu</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Crect width='64' height='64' rx='12' fill='%231c1f44'/%3E%3Cpath d='M10 42h44' stroke='%2306b6d4' stroke-width='6' stroke-linecap='round'/%3E%3Ctext x='14' y='40' font-family='Inter, Arial' font-size='20' fill='%23a78bfa' font-weight='800'%3EA%3C/text%3E%3C/svg%3E" />
  <link rel="stylesheet" href="assets/css/styles.css" />
</head>
<body>
  <header class="app-header">
    <a class="brand" href="index.html" aria-label="Trang chủ">FlashSheet</a>
    <nav class="nav">
      <a href="study.html" class="nav-btn">Học từ</a>
      <a href="index.html" class="nav-btn">Luyện tập</a>
      <a href="admin.html" class="nav-btn" aria-current="page">Nhập dữ liệu</a>
      <a href="guide.html" class="nav-btn secondary">Hướng dẫn</a>
    </nav>
  </header>

  <main class="container narrow">
    <h1 class="page-title">Nhập dữ liệu từ vựng</h1>

    <form id="wordForm" class="data-form">
      <div class="form-row">
        <label for="wordInput">Từ vựng</label>
  <input type="text" id="wordInput" class="answer-input word-input" placeholder="Nhập từ (ví dụ: apple)" required />
      </div>

      <div class="form-row">
        <label for="posInput">Loại từ (nếu có)</label>
        <input type="text" id="posInput" class="answer-input" placeholder="ví dụ: n. / v. / adj. / adv." />
      </div>

      <div class="form-row">
        <label>Mô tả / Định nghĩa</label>
        <div id="defsContainer" class="defs-container"></div>
        <button type="button" id="btnAddDef" class="btn small">+ Thêm mô tả</button>
      </div>

      <div class="form-row">
        <label>Ví dụ / Câu mẫu (English)</label>
        <div id="examplesContainer" class="defs-container"></div>
        <button type="button" id="btnAddExample" class="btn small">+ Thêm ví dụ</button>
        <p class="hint">Ghi mỗi ví dụ trong một ô. Khi luyện tập, một ví dụ có thể được chọn làm câu hỏi và từ trả lời sẽ được thay bằng dấu gạch ngang.</p>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn primary">Lưu vào trình duyệt</button>
        <button type="button" id="btnReset" class="btn secondary">Xóa trắng</button>
      </div>
    </form>

    <section class="io-panel">
      <div class="io-actions">
        <!-- <label class="btn" for="importFile">Nhập CSV/JSON (tuỳ chọn)
          <input type="file" id="importFile" accept="application/json,.json,text/csv,.csv" hidden />
        </label> -->
        <button id="btnSync" class="btn primary" title="Đồng bộ 2 chiều với Google Sheet (không xoá dữ liệu)">Đồng bộ (Sheet ↔ Local)</button>
      </div>
      <p class="hint">Dữ liệu mặc định lưu trong Local Storage. Nên cấu hình Google Sheet để đồng bộ giữa các thiết bị. Nút “Đồng bộ” sẽ tải từ Sheet về và đẩy các từ mới từ Local lên Sheet (không xoá dữ liệu ở hai phía).</p>
    </section>

    <section class="io-panel" id="srs-config">
      <h2>Cài đặt học nhắc lại (SRS)</h2>
      <div class="form-row">
        <label for="dailyNewLimit">Số từ mới mỗi ngày</label>
        <input type="number" id="dailyNewLimit" class="answer-input" value="20" min="0" />
      </div>
      <div class="form-row">
        <label for="dailyReviewLimit">Giới hạn ôn lại mỗi ngày (0 = không giới hạn)</label>
        <input type="number" id="dailyReviewLimit" class="answer-input" value="0" min="0" />
      </div>
      <div class="io-actions">
        <button id="btnSaveSrsCfg" class="btn secondary">Lưu cài đặt SRS</button>
      </div>
      <p class="hint">Mỗi ngày khi mở trang Luyện tập, ứng dụng sẽ xếp hàng ôn tập theo lịch (thẻ đến hạn trước, sau đó giới thiệu tối đa số từ mới).</p>
    </section>

    

    <section class="io-panel" id="sheet-config">
      <h2>Đồng bộ Google Sheet</h2>
      <p class="hint">Để đọc tự động, hãy Publish sheet thành CSV (File → Share → Publish to web) và dán URL CSV. Để ghi tự động, triển khai Apps Script nhận POST (mẫu có trong README) rồi dán URL web app ở dưới.</p>
      <div class="form-row">
        <label for="sheetCsvUrl">CSV URL (Publish to web → CSV)</label>
        <input type="url" id="sheetCsvUrl" class="answer-input" placeholder="https://docs.google.com/spreadsheets/d/e/.../pub?output=csv" />
      </div>
      <div class="form-row">
        <label for="sheetWriteUrl">Apps Script Write URL (tuỳ chọn, để auto-append)</label>
        <input type="url" id="sheetWriteUrl" class="answer-input" placeholder="https://script.google.com/macros/s/.../exec" />
      </div>
      <div class="form-row">
        <label for="sheetTranslateUrl">Apps Script Translate URL (tuỳ chọn, dịch câu)</label>
        <input type="url" id="sheetTranslateUrl" class="answer-input" placeholder="https://script.google.com/macros/s/.../exec" />
      </div>
      <div class="form-row">
        <label for="sheetTtsUrl">Apps Script TTS URL (tuỳ chọn, phát âm qua audio)</label>
        <input type="url" id="sheetTtsUrl" class="answer-input" placeholder="https://script.google.com/macros/s/.../exec" />
        <div class="hint">Endpoint nên trả về audio/mp3 khi GET: <code>?text=...&lang=en</code>. Dùng để fallback khi Web Speech bị chặn.</div>
      </div>
      <div class="form-row">
        <button type="button" id="btnUseThienPreset" class="btn secondary">Dùng bộ từ của thienpahm (lưu vào storage)</button>
      </div>
      <div class="form-row">
        <label><input type="checkbox" id="sheetAutoOnLearn" /> Tự động tải từ Sheet khi mở trang học</label>
      </div>
      <div class="form-row">
        <label for="sheetRefreshSec">Khoảng làm mới (giây)</label>
        <input type="number" id="sheetRefreshSec" class="answer-input" value="120" min="15" />
      </div>
      <div class="io-actions">
        <button id="btnSheetLoad" class="btn">Tải từ Sheet</button>
        <button id="btnSheetSaveCfg" class="btn secondary">Lưu cấu hình</button>
      </div>
    </section>

    <!-- Move the dataset box to the very bottom, collapsible by default -->
    <section class="dataset-list">
      <details id="datasetCollapse">
        <summary class="collapsible-header">
          <span>Bộ từ hiện có</span>
          <span id="datasetCount" class="muted-count">— 0 từ</span>
          <span class="chev" aria-hidden="true">▾</span>
        </summary>
        <div id="datasetInfo" class="dataset-info">Đang tải…</div>
        <ul id="datasetList" class="list"></ul>
      </details>
    </section>
  </main>

  <footer class="app-footer">
    <span>Quay lại tab “Luyện tập” để ôn tập nhanh, hoặc tab “Học từ” để xem flashcard.</span>
  </footer>

  <script src="assets/js/config.js"></script>
  <script src="assets/js/utils.js"></script>
  <script src="assets/js/srs.js"></script>
  <script src="assets/js/admin.js"></script>
</body>
</html>
